<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Azzam Assistant • Admin</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
      :root{
        /* Green-forward Hailaman identity (slightly lighter) */
        --bg:#0f241c;         /* page background */
        --surface:#122920;    /* cards/nav surfaces */
        --muted:#a3beaf;      /* secondary text */
        --text:#f0faf5;       /* primary text */
        --brand:#22c55e;      /* primary brand */
        --brand-2:#34d399;    /* gradient accent */
        --stroke:#1c4d3b;     /* borders */
        --ok:#22c55e;         /* success */
        --warn:#f59e0b;       /* warning */
        --err:#ef4444;        /* error */
      }
      *{box-sizing:border-box}
      html,body{height:100%}
      body{margin:0; background:radial-gradient(1000px 800px at 70% -20%, rgba(34,197,94,.14), transparent 60%), var(--bg); color:var(--text); font-family: Inter, Cairo, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;}
      a{color:inherit}
      .container{max-width:1100px; margin:0 auto; padding:24px}
      #app-root.rtl{direction:rtl; text-align:right}
      #app-root.ltr{direction:ltr; text-align:left}
      .header{position:sticky; top:0; backdrop-filter:saturate(180%) blur(8px); background:linear-gradient(180deg, rgba(10,24,18,0.96), rgba(10,24,18,0.90)); border-bottom:1px solid var(--stroke);}
      .header-inner{max-width:1100px; margin:0 auto; padding:14px 24px; display:flex; align-items:center; justify-content:space-between}
      .brand{display:flex; align-items:center; gap:10px; font-weight:700; letter-spacing:.2px}
      .logo{width:28px; height:28px; border-radius:8px; background:linear-gradient(135deg, var(--brand), var(--brand-2)); box-shadow:0 6px 24px rgba(34,197,94,.25); overflow:hidden}
      .nav{display:flex; gap:8px}
      .lang-toggle{display:flex; gap:6px; align-items:center; margin-left:8px}
      .lang-toggle .btn.active{border-color: var(--brand); color:#fff; text-decoration: underline;}
      .btn{appearance:none; border:1px solid var(--stroke); background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02)); color:var(--text); padding:9px 12px; border-radius:10px; cursor:pointer; font-weight:600}
      .btn:hover{border-color:#2a3553}
      .btn.primary{border-color:transparent; background:linear-gradient(135deg, var(--brand), var(--brand-2)); color:white; box-shadow:0 10px 30px rgba(34,211,238,.22)}
      .btn.ghost{background:transparent}
      .grid{display:grid; grid-template-columns:repeat(12,1fr); gap:16px; grid-auto-flow:row dense}
      .card{background:var(--surface); border:1px solid var(--stroke); border-radius:16px; padding:18px; box-shadow:0 10px 28px rgba(0,0,0,.25), 0 6px 16px rgba(34,197,94,.06)}
      .card:hover{border-color:#246b52}
      /* Equal-height job cards (more compact) */
      .job-card{min-height:110px; display:flex; flex-direction:column; justify-content:space-between; height:100%; padding:14px 18px}

      /* Skeleton loading */
      @keyframes shimmer{0%{transform:translateX(-150%)}100%{transform:translateX(150%)}}
      .skeleton{position:relative; overflow:hidden}
      .skeleton::after{content:""; position:absolute; top:0; left:0; height:100%; width:100%; background:linear-gradient(90deg, transparent, rgba(255,255,255,.05), transparent); animation:shimmer 1.1s infinite}
      .skeleton-line{height:12px; background:rgba(255,255,255,.06); border-radius:8px}
      .skeleton-line.sm{height:10px; width:40%; margin-top:6px}
      .skeleton-line.md{height:12px; width:65%; margin-top:10px}
      .skeleton-line.lg{height:16px; width:85%; margin-top:8px}
      .muted{color:var(--muted)}
      .chips{display:flex; flex-wrap:wrap; gap:6px}
      .chip{background:rgba(255,255,255,.06); border:1px solid var(--stroke); padding:4px 8px; border-radius:999px; font-size:12px; color:var(--muted)}
      label{display:block; font-weight:600; margin:10px 0 6px}
      input, textarea{width:100%; background:rgba(255,255,255,.04); border:1px solid var(--stroke); color:var(--text); border-radius:10px; padding:10px}
      textarea{resize:vertical}
      .rows{display:flex; flex-direction:column; gap:12px}
      .row{display:flex; gap:12px}
      .col{flex:1}
      .list{display:flex; flex-direction:column; gap:10px; max-height:520px; overflow:auto}
      .item{padding:12px; border:1px dashed var(--stroke); border-radius:12px; cursor:pointer}
      .item:hover{border-color:#2a3553}
      .tabs{display:flex; gap:8px; margin:12px 0 16px}
      .tab{padding:8px 12px; border-radius:999px; border:1px solid var(--stroke); cursor:pointer; color:var(--muted)}
      .tab.active{color:white; border-color:transparent; background:linear-gradient(135deg, var(--brand), var(--brand-2));}
      .kbd{display:inline-block; border:1px solid var(--stroke); border-bottom-width:2px; padding:0 6px; border-radius:6px; font-size:12px; color:var(--muted)}
      .section-title{margin:6px 0 12px; font-size:14px; color:var(--muted); text-transform:uppercase; letter-spacing:.12em}
      .title{margin:0 0 6px}
      .sub{margin:0; color:var(--muted)}
      .inline-actions{display:flex; gap:8px; align-items:center}
      .danger{color:#fecaca}
      .success{color:#a7f3d0}
      .divider{height:1px; background:var(--stroke); margin:14px 0}
      .push{margin-inline-start:auto}
    </style>
  </head>
  <body>
    <header class="header">
      <div class="header-inner">
        <div class="brand">
          <div class="logo" id="brand-logo"></div>
          <div id="brand-name">Azzam Assistant • Admin</div>
        </div>
        <nav class="nav">
          <button class="btn ghost" id="nav-jobs">Jobs</button>
          <button class="btn primary" id="nav-create">Create Job</button>
          <div class="lang-toggle">
          <button class="btn ghost" id="lang-en">English</button>
          <span class="muted">|</span>
          <button class="btn ghost" id="lang-ar">العربية</button>
          </div>
        </nav>
      </div>
    </header>
    <div class="container" id="app-root">
      <div id="root"></div>
    </div>

    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script>
      const e = React.createElement;
      const { useState, useEffect } = React;
      // Load branding (sets logo background image; falls back to gradient)
      fetch('/__app_config.json').then(r=>r.json()).then(cfg=>{
        const logo = document.getElementById('brand-logo');
        const name = document.getElementById('brand-name');
        if (logo && cfg.brandIcon) {
          const iconUrl = encodeURI(cfg.brandIcon);
          logo.style.backgroundImage = `linear-gradient(135deg, var(--brand), var(--brand-2))`;
          // Put image layer on top
          logo.style.backgroundImage = `url("${iconUrl}"), ` + logo.style.backgroundImage;
          logo.style.backgroundSize = 'cover, cover';
          logo.style.backgroundPosition = 'center, center';
          logo.style.backgroundRepeat = 'no-repeat, no-repeat';
        }
        if (name && cfg.brandName) name.textContent = cfg.brandName;
      }).catch(()=>{});

      // Admin i18n
      const I18N = { locales:{}, lang:'en' };
      function getAdminLang(){ return localStorage.getItem('admin_lang') || 'en'; }
      function applyDir(lang){
        document.documentElement.dir = (lang==='ar'?'rtl':'ltr');
        const root = document.getElementById('app-root');
        if (root){ root.classList.remove('rtl','ltr'); root.classList.add(lang==='ar'?'rtl':'ltr'); }
      }
      function t(key){
        const parts = key.split('.');
        const lang = I18N.lang || 'en';
        let cur = I18N.locales[lang] || {};
        for (const p of parts) cur = (cur||{})[p];
        if (cur == null){ cur = I18N.locales['en'] || {}; for (const p of parts) cur = (cur||{})[p]; }
        return cur || key;
      }
      async function loadLocales(){
        const [en, ar] = await Promise.all([
          fetch('/locales/en.json').then(r=>r.json()),
          fetch('/locales/ar.json').then(r=>r.json())
        ]);
        I18N.locales = { en, ar };
        I18N.lang = getAdminLang();
        applyDir(I18N.lang);
        const btnJobs = document.getElementById('nav-jobs');
        const btnCreate = document.getElementById('nav-create');
        if (btnJobs) btnJobs.textContent = t('admin.jobs');
        if (btnCreate) btnCreate.textContent = t('admin.createJob');
        const enBtn = document.getElementById('lang-en');
        const arBtn = document.getElementById('lang-ar');
        if (enBtn) enBtn.classList.toggle('active', I18N.lang==='en');
        if (arBtn) arBtn.classList.toggle('active', I18N.lang==='ar');
      }

      function TextArea({label, value, set, rows=4, placeholder=''}) {
        return e('div', {}, [
          e('label', { key:'l' }, label),
          e('textarea', { key:'t', rows, value: value||'', placeholder, onChange:(ev)=>set(ev.target.value) })
        ]);
      }

      function TextInput({label, value, set, placeholder=''}) {
        return e('div', {}, [
          e('label', { key:'l' }, label),
          e('input', { key:'i', value: value||'', placeholder, onChange:(ev)=>set(ev.target.value) })
        ]);
      }

      function DynamicList({label, items, setItems, placeholder}) {
        const add = () => setItems([...(items||[]), '']);
        const setIdx = (i, v) => { const c = items.slice(); c[i] = v; setItems(c); };
        const del = (i) => { const c = items.slice(); c.splice(i,1); setItems(c); };
        return e('div', {}, [
          e('label', { key:'l' }, label),
          e('div', { key:'rows', className:'rows' }, (items||[]).map((it, idx)=> e('div', { className:'row', key:idx }, [
            e('input', { className:'col', value:it, placeholder, onChange:(ev)=>setIdx(idx, ev.target.value) }),
            e('button', { className:'btn', onClick:()=>del(idx) }, 'Remove')
          ]))),
          e('button', { key:'b', className:'btn', onClick:add, style:{marginTop:6}}, 'Add')
        ]);
      }

      function CreateJob({ onCreated, onCancel }) {
        const [title, setTitle] = useState('');
        const [description, setDescription] = useState('');
        const [responsibilities, setResponsibilities] = useState('');
        const [requirements, setRequirements] = useState('');
        const [skills, setSkills] = useState('');
        const [benefits, setBenefits] = useState('');
        const [questions, setQuestions] = useState(['']);
        const [recipients, setRecipients] = useState(['']);
        const [busy, setBusy] = useState(false);
        const submit = async () => {
          if (!title || questions.filter(Boolean).length === 0) { alert('Title and at least one question required'); return; }
          setBusy(true);
          const res = await fetch('/api/jobs', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ title, description, responsibilities, requirements, skills, benefits, questions, recipients }) });
          setBusy(false);
          if (!res.ok) return alert('Failed to create job');
          const data = await res.json();
          onCreated && onCreated(data.job);
        };
        return e('div', { className:'card' }, [
          e('h2', { className:'title', key:'h' }, 'Create Job'),
          e('p', { className:'sub', key:'p' }, 'Define the role, add questions, and invite candidates.'),
          e('div', { className:'grid', style:{marginTop:8}, key:'grid' }, [
            e('div', { className:'col', style:{gridColumn:'span 12'} }, [
              TextInput({label:'Job Title', value:title, set:setTitle, placeholder:'e.g., Backend Engineer'})
            ]),
            e('div', { className:'col', style:{gridColumn:'span 6'} }, [
              TextArea({label:'Description', value:description, set:setDescription, rows:5, placeholder:'High-level role overview'})
            ]),
            e('div', { className:'col', style:{gridColumn:'span 6'} }, [
              TextArea({label:'Responsibilities', value:responsibilities, set:setResponsibilities, rows:5})
            ]),
            e('div', { className:'col', style:{gridColumn:'span 6'} }, [
              TextArea({label:'Requirements', value:requirements, set:setRequirements, rows:5})
            ]),
            e('div', { className:'col', style:{gridColumn:'span 6'} }, [
              TextArea({label:'Skills', value:skills, set:setSkills, rows:4})
            ]),
            e('div', { className:'col', style:{gridColumn:'span 6'} }, [
              TextArea({label:'Benefits', value:benefits, set:setBenefits, rows:4})
            ]),
            e('div', { className:'col', style:{gridColumn:'span 6'} }, [
              DynamicList({label:'Questions', items:questions, setItems:setQuestions, placeholder:'Type a question...'})
            ]),
            e('div', { className:'col', style:{gridColumn:'span 6'} }, [
              DynamicList({label:'Candidate Recipients (+E164)', items:recipients, setItems:setRecipients, placeholder:'+9665...'})
            ])
          ]),
          e('div', { className:'inline-actions', style:{marginTop:12} }, [
            e('button', { className:'btn primary', onClick:submit, disabled:busy }, busy?'Creating...':'Create Job'),
            e('button', { className:'btn', onClick:onCancel }, 'Cancel')
          ])
        ]);
      }

      function JobCard({ job, onOpen }){
        return e('div', { className:'card job-card', onClick:()=>onOpen(job), style:{cursor:'pointer'} }, [
          e('div', { className:'inline-actions' }, [
            e('h3', { className:'title', style:{marginRight:'auto'} }, job.title),
            e('span', { className:'chip' }, job.jobId)
          ]),
          e('div', { className:'inline-actions', style:{margin:'4px 0 8px'} }, [
            e('span', { className:'chip' }, (job.language||'en').toUpperCase()),
            e('span', { className:'muted push' }, `${(job.questions||[]).length} ${t('admin.questions')} • ${(job.candidateRecipients||[]).length} ${t('admin.candidates')}`)
          ]),
        ]);
      }

      function JobList({ onSelect, onCreate }) {
        const [jobs, setJobs] = useState([]);
        const [loading, setLoading] = useState(true);
        const load = async () => {
          try {
            setLoading(true);
            const res = await fetch('/api/jobs');
            const data = await res.json();
            setJobs(Array.isArray(data) ? data : []);
          } catch(_) {
            setJobs([]);
          } finally {
            setLoading(false);
          }
        };
        useEffect(()=>{ load(); }, []);
        return e('div', {}, [
          e('div', { className:'grid', style:{gridTemplateColumns:'repeat(12, 1fr)'} },
            loading
              ? [0,1,2].map(i => e('div', { key:'sk'+i, style:{gridColumn:'span 6'} },
                  e('div', { className:'card job-card skeleton' }, [
                    e('div', { className:'skeleton-line lg' }),
                    e('div', { className:'skeleton-line md' })
                  ])
                ))
              : (jobs.length
                  ? jobs.map(j => e('div', { key:j.jobId, style:{gridColumn:'span 6'} }, e(JobCard, { job:j, onOpen:onSelect })))
                  : e('div', { className:'muted' }, 'No jobs yet — create your first role.'))
          )
        ]);
      }

      function JobDetailsTab({ job, onSaved }) {
        const [title, setTitle] = useState(job.title||'');
        const [language] = useState(job.language||'en');
        const [description, setDescription] = useState(job.description||'');
        const [responsibilities, setResponsibilities] = useState(job.responsibilities||'');
        const [requirements, setRequirements] = useState(job.requirements||'');
        const [skills, setSkills] = useState(job.skills||'');
        const [benefits, setBenefits] = useState(job.benefits||'');
        const [questions, setQuestions] = useState(job.questions||['']);
        const [recipients, setRecipients] = useState(job.candidateRecipients||['']);
        const [busy, setBusy] = useState(false);
        const save = async () => {
          setBusy(true);
          const res = await fetch(`/api/jobs/${job.jobId}`, { method:'PUT', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ title, description, responsibilities, requirements, skills, benefits, questions, recipients }) });
          setBusy(false);
          if (!res.ok) return alert(t('admin.failedSave'));
          const data = await res.json();
          onSaved && onSaved(data.job);
          alert(t('admin.saved'));
        };
        return e('div', { className:'grid', style:{gridTemplateColumns:'repeat(12, 1fr)'} }, [
          e('div', { className:'col', style:{gridColumn:'span 6'} }, [
            TextInput({label:t('admin.jobTitle'), value:title, set:setTitle}),
            e('div', {}, [ e('label', {}, t('admin.language')), e('div', { className:'chip', style:{ display:'inline-block', marginTop:6 } }, language.toUpperCase()) ]),
            TextArea({label:t('admin.description'), value:description, set:setDescription, rows:5}),
            TextArea({label:t('admin.responsibilities'), value:responsibilities, set:setResponsibilities, rows:5}),
            TextArea({label:t('admin.requirements'), value:requirements, set:setRequirements, rows:5}),
          ]),
          e('div', { className:'col', style:{gridColumn:'span 6'} }, [
            TextArea({label:t('admin.skills'), value:skills, set:setSkills, rows:4}),
            TextArea({label:t('admin.benefits'), value:benefits, set:setBenefits, rows:4}),
            DynamicList({label:t('admin.questions'), items:questions, setItems:setQuestions, placeholder:'Type a question...'}),
            DynamicList({label:t('admin.candidates'), items:recipients, setItems:setRecipients, placeholder:'+9665...'})
          ]),
          e('div', { className:'col', style:{gridColumn:'span 12'} }, [
            e('div', { className:'inline-actions', style:{marginTop:12} }, [
              e('button', { className:'btn primary', onClick:save, disabled:busy }, busy?t('admin.loading'):t('admin.save'))
            ])
          ])
        ]);
      }

      function JobSubmissionsTab({ job }) {
        const [subs, setSubs] = useState([]);
        const load = async () => { const res = await fetch(`/api/jobs/${job.jobId}/submissions`); const data = await res.json(); setSubs(data); };
        useEffect(()=>{ load(); }, [job.jobId]);
        return e('div', { className:'grid', style:{gridTemplateColumns:'repeat(12, 1fr)'} },
          (subs||[]).map(s => e('div', { key:s._id, style:{gridColumn:'span 12'} }, e('div', { className:'card' }, [
            e('details', {}, [
              e('summary', { className:'inline-actions' }, [
                e('div', { className:'title', style:{marginRight:'auto'} }, `+ ${s.applicantPhone}`),
                e('span', { className:'chip success' }, `Score ${s.aiScore}`),
                e('span', { className:'chip' }, s.aiDecision)
              ]),
              e('div', { className:'divider' }),
              e('details', { style:{marginBottom:10} }, [
                e('summary', { className:'muted' }, `${t('admin.answers')} (${(s.answers||[]).length})`),
                e('div', { className:'rows', style:{marginTop:10} }, (s.answers||[]).map((qa, i) => e('div', { className:'item', key:i, style:{cursor:'default'} }, [
                  e('div', { className:'muted' }, `${t('admin.q')} ${i+1}: ${qa.question}`),
                  e('div', {}, qa.answer)
                ])))
              ]),
              e('div', { className:'divider' }),
              e('details', {}, [
                e('summary', { className:'muted' }, t('admin.aiSummary')),
                e('div', { className:'rows', style:{marginTop:10} }, [
                  e('div', {}, [e('div', { className:'muted' }, t('admin.strengths')), e('div', {}, (Array.isArray(s.aiStrengths)? s.aiStrengths.join(' • ') : (s.aiStrengths||'-')) )]),
                  e('div', {}, [e('div', { className:'muted' }, t('admin.weaknesses')), e('div', {}, (Array.isArray(s.aiWeaknesses)? s.aiWeaknesses.join(' • ') : (s.aiWeaknesses||'-')) )]),
                  e('div', {}, [e('div', { className:'muted' }, t('admin.summary')), e('div', {}, s.aiSummary || '-')])
                ])
              ])
            ])
          ])))
        );
      }

      function JobDetailsPage({ job, onBack }) {
        const [tab, setTab] = useState('details');
        const [cur, setCur] = useState(job);
        return e('div', {}, [
          e('div', { className:'inline-actions', style:{marginBottom:12} }, [
            e('button', { className:'btn', onClick:onBack }, '← '+t('admin.back')),
            e('div', { className:'push' })
          ]),
          e('div', { className:'card' }, [
            e('div', { className:'inline-actions' }, [
              e('div', {}, [ e('h2', { className:'title' }, cur.title), e('div', { className:'sub' }, cur.jobId) ]),
            ]),
            e('div', { className:'tabs' }, [
              e('div', { className:'tab '+(tab==='details'?'active':''), onClick:()=>setTab('details') }, t('admin.details')),
              e('div', { className:'tab '+(tab==='subs'?'active':''), onClick:()=>setTab('subs') }, t('admin.submissions'))
            ]),
            tab==='details' ? e(JobDetailsTab, { job: cur, onSaved: setCur }) : e(JobSubmissionsTab, { job: cur })
          ])
        ]);
      }

      function CreateJobModal({ open, onClose, onCreated }){
        const [title, setTitle] = useState('');
        const [language, setLanguage] = useState('en');
        const [busy, setBusy] = useState(false);
        if (!open) return null;
        const submit = async () => {
          if (!title) return alert(t('admin.enterTitle'));
          setBusy(true);
          const res = await fetch('/api/jobs', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ title, language }) });
          setBusy(false);
          if (!res.ok) return alert(t('admin.failedCreate'));
          const data = await res.json();
          onCreated && onCreated(data.job);
        };
        return e('div', { style:{position:'fixed', inset:0, background:'rgba(0,0,0,.45)', display:'flex', alignItems:'center', justifyContent:'center', zIndex:1000} },
          e('div', { className:'card', style:{width:420} }, [
            e('h3', { className:'title' }, t('admin.createJob')),
            e('div', { className:'rows' }, [
              TextInput({label:t('admin.jobTitle'), value:title, set:setTitle, placeholder:'e.g., Backend Engineer'}),
              e('div', {}, [
                e('label', {}, t('admin.language')),
                e('select', { value:language, onChange:(ev)=>setLanguage(ev.target.value), style:{ width:'100%', background:'rgba(255,255,255,.04)', border:'1px solid var(--stroke)', color:'var(--text)', borderRadius:10, padding:10 } }, [
                  e('option', { value:'ar' }, 'العربية (ar)'),
                  e('option', { value:'en' }, 'English (en)')
                ])
              ])
            ]),
            e('div', { className:'inline-actions', style:{marginTop:12} }, [
              e('button', { className:'btn', onClick:onClose }, t('admin.cancel')),
              e('button', { className:'btn primary', onClick:submit, disabled:busy }, busy?t('admin.loading'):t('admin.continue'))
            ])
          ])
        );
      }

      function App() {
        const [page, setPage] = useState('list'); // 'list' | 'details'
        const [selected, setSelected] = useState(null);
        const [modalOpen, setModalOpen] = useState(false);
        useEffect(()=>{
          const jobsBtn = document.getElementById('nav-jobs');
          const createBtn = document.getElementById('nav-create');
          const enBtn = document.getElementById('lang-en');
          const arBtn = document.getElementById('lang-ar');
          if (jobsBtn) jobsBtn.onclick = ()=> { setPage('list'); setModalOpen(false); };
          if (createBtn) createBtn.onclick = ()=> setModalOpen(true);
          if (enBtn) enBtn.onclick = ()=> { I18N.lang='en'; localStorage.setItem('admin_lang','en'); applyDir('en'); if (jobsBtn) jobsBtn.textContent=t('admin.jobs'); if (createBtn) createBtn.textContent=t('admin.createJob'); enBtn.classList.add('active'); if (arBtn) arBtn.classList.remove('active'); setPage(p=>p); };
          if (arBtn) arBtn.onclick = ()=> { I18N.lang='ar'; localStorage.setItem('admin_lang','ar'); applyDir('ar'); if (jobsBtn) jobsBtn.textContent=t('admin.jobs'); if (createBtn) createBtn.textContent=t('admin.createJob'); arBtn.classList.add('active'); if (enBtn) enBtn.classList.remove('active'); setPage(p=>p); };
          // initialize labels
          if (jobsBtn) jobsBtn.textContent = t('admin.jobs');
          if (createBtn) createBtn.textContent = t('admin.createJob');
        },[]);
        return e('div', { className:'rows' }, [
          e(CreateJobModal, { open: modalOpen, onClose: ()=>setModalOpen(false), onCreated: (j)=>{ setSelected(j); setModalOpen(false); setPage('details'); } }),
          page==='list' && e(JobList, { onSelect: (j)=>{ setSelected(j); setPage('details'); } }),
          page==='details' && selected && e(JobDetailsPage, { job: selected, onBack: ()=>setPage('list') })
        ]);
      }

      (async function init(){
        await loadLocales();
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(e(App));
      })();
    </script>
  </body>
  </html>
